steps:
  #
  # Shellcheck!
  #
  - label: "Shellcheck :bash:"
    command:
      - ./test/shellcheck.sh
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] builder-api-client"
    command:
      - ./test/run_cargo_test.sh builder-api-client
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] butterfly"
    command:
      - ./test/run_cargo_test.sh butterfly
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] common"
    command:
      - ./test/run_cargo_test.sh common
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] eventsrv"
    command:
      - ./test/run_cargo_test.sh eventsrv
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] eventsrv-client"
    command:
      - ./test/run_cargo_test.sh eventsrv-client
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] eventsrv-protocol"
    command:
      - ./test/run_cargo_test.sh eventsrv-protocol
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] hab"
    command:
      - ./test/run_cargo_test.sh hab
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] launcher-client"
    command:
      - ./test/run_cargo_test.sh launcher-client
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] launcher-protocol"
    command:
      - ./test/run_cargo_test.sh launcher-protocol
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] pkg-export-docker"
    command:
      - ./test/run_cargo_test.sh pkg-export-docker
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] pkg-export-helm"
    command:
      - ./test/run_cargo_test.sh pkg-export-helm
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] pkg-export-kubernetes"
    command:
      - ./test/run_cargo_test.sh pkg-export-kubernetes
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] pkg-export-tar"
    command:
      - ./test/run_cargo_test.sh pkg-export-tar
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] sup"
    command:
      - ./test/run_cargo_test.sh sup
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] sup-client"
    command:
      - ./test/run_cargo_test.sh sup-client
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"

  - label: "[unit] sup-protocol"
    command:
      - ./test/run_cargo_test.sh sup-protocol
    agents:
      queue: 'docker-privileged'
    plugins:
      docker#v2.1.0:
        image: "chefes/buildkite"
