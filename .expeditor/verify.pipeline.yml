expeditor:
  defaults:
    buildkite:
      timeout_in_minutes: 30

steps:
#######################################################################
# Linting!
#######################################################################

  - label: "[lint] :linux: :bash: Shellcheck"
    command:
      - ./test/shellcheck.sh
    timeout_in_minutes: 10
    retry:
      automatic:
        limit: 1
    expeditor:
      executor:
        docker:

  - label: "[lint] :linux: :bash: rustfmt"
    command:
      - ./support/ci/rustfmt.sh
    timeout_in_minutes: 10
    retry:
      automatic:
        limit: 1
    expeditor:
      executor:
        docker:

  - label: "[lint] :linux: :paperclip: clippy!"
    command:
      - sudo yum install gcc -y # install GCC since it's required for the cargo build
      - sudo yum update bash # make sure we have 4.4 or later
      - sudo make lint
    timeout_in_minutes: 10
    retry:
      automatic:
        limit: 1
    expeditor:
      executor:
        linux:
          single-use: true
          privileged: true
